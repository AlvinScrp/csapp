

This directory contains the files that you will need to run the CS:APP
Data Lab, which helps develops the student's understanding of bit
representations, two's complement arithmetic, and IEEE floating point.

For fun, we've also provided a new user-level HTTP-based "Beat the
Prof" contest that replaces the old email-based version. The new
contest is completely self-contained and does not require root
password.  The only requirement is that you have a user account on a
Linux machine with an IP address.

System requirements: Uses bison and flex to build dlc.

这个目录包含运行 CS:APP Data Lab 所需的文件，该实验室帮助学生理解位表示、二进制补码算术和IEEE浮点数。

另外，我们还提供了一个基于HTTP的新用户级别的“击败教授”竞赛，取代了旧的基于电子邮件的版本。这个新竞赛是完全自包含的，不需要root密码。唯一的要求是您在一个具有IP地址的Linux机器上有一个用户账户。

系统要求：使用bison和flex来构建dlc。


************
1. Overview
************

In this lab, students work on a C file, called bits.c, that consists of a series of programming "puzzles".  Each puzzle is an empty function body that must be completed so that it implements a specified mathematical function, such as "absolute value". Students must solve the non-floating point puzzles using only straight-line C code and a restricted set of C arithmetic and logical operators. For the floating-point puzzles they can use conditionals and arbitrary operators.

在这个实验室中，学生们需要处理一个名为bits.c的C语言文件，其中包含一系列编程“谜题”。每个谜题都是一个空的函数体，学生们必须完成这些函数，使其实现指定的数学函数，比如“绝对值”。学生们必须仅使用直线C代码和一组受限的C算术和逻辑运算符来解决非浮点数谜题。对于浮点数谜题，他们可以使用条件语句和任意的运算符。

Students use the following three tools to check their work. Instructors use the same tools to assign grades.
学生们使用以下三种工具来检查他们的工作。 教师们也使用相同的工具来评分。

1. dlc: A "data lab compiler" that checks each function in bits.c for
   compliance with the coding guidelines, checking that the students use
   less than the maximum number of operators, that they use only
   straight-line code, and that they use only legal operators. The
   sources and a Linux binary are included with the lab.
   
   dlc：一种“数据实验室编译器”，用于检查bits.c中每个函数是否符合编码准则，检查学生是否使用少于最大数量的运算符，是否仅使用直线代码，并且是否仅使用合法的运算符。实验室附带了源代码和Linux二进制文件。

2. btest: A test harness that checks the functions in bits.c for correctness. This tool has been significantly improved, now checking wide swaths around the edge cases for integers and floating point representations such as 0, Tmin, denorm-norm boundary, and inf.
   
   **btest**：一个测试工具，用于检查bits.c中函数的正确性。这个工具已经显著改进，现在检查整数和浮点数表示的边缘情况，例如0、Tmin、denorm-norm边界和inf附近的广泛范围。

3. driver.pl: A autograding driver program that uses dlc and btest to check each test function in bits.c for correctness and adherence to the coding guidelines
   **driver.pl**：一个自动评分的驱动程序，使用dlc和btest来检查bits.c中每个测试函数的正确性和符合编码准则的情况。

The default version of the lab consists of 15 puzzles, in ./src/selections.c, chosen from a set of 73 standard puzzles defined in the directory ./src/puzzles/. You can customize the lab from term to term by choosing a different set of puzzles from the standard set of puzzles.

You can also define new puzzles of your own and add them to the standard set. See ./src/README for instructions on how to add new puzzles to the standard set.

NOTE: If you define new puzzles, please send them to me (Dave O'Hallaron, droh@cs.cmu.edu) so that I can add them to the standard set of puzzles in the data lab distribution.

默认版本的实验室包括来自./src/puzzles/目录下定义的73个标准谜题中选择的15个谜题，放在./src/selections.c中。您可以通过选择不同的标准谜题集合来每学期自定义实验室内容。

您也可以定义自己的新谜题，并将其添加到标准谜题集合中。请参阅./src/README文件，了解如何向标准谜题集合中添加新谜题的说明。

注意：如果您定义了新的谜题，请将它们发送给我（Dave O'Hallaron，droh@cs.cmu.edu），以便我将它们添加到数据实验室分发中的标准谜题集合中。

********
2. Files
********

All CS:APP labs have the same simple top-level directory structure:

Makefile	   Builds the entire lab.
README		   This file.
src/		   Contains all source files for the lab.
datalab-handout/   Handout directory that goes to the students. Generated by the Makefile from files in ./src. Never modify anything in this directory.
grade/		   Autograding scripts that instructors can use to grade student handins.
writeup/	   Sample Latex lab writeup.
contest/           Everything needed for the optional "Beat the Prof" contest.

所有CS:APP实验室都具有相同的简单顶层目录结构：

- **Makefile**：用于构建整个实验室的文件。
- **README**：本文件。
- **src/**：包含实验室的所有源文件。
- **datalab-handout/**：学生所需的发放目录。由Makefile从./src中的文件生成。请勿修改此目录中的任何内容。
- **grade/**：教师用来评分学生提交作业的自动评分脚本。
- **writeup/**：示例的LaTeX实验室报告撰写文件夹。
- **contest/**：可选的“击败教授”竞赛所需的所有内容。

********************
3. Building the Lab
*******************

Step 0. If you decide to run the "Beat the Prof" contest (section 5), then edit the ./contest/Contest.pm file so that the driver knows where to send the results. See ./contest/README for the simple instructions. If you decide *not* to offer the contest, then do nothing in this step.

Step 1. Select the puzzles you want to include by editing the file ./src/selections.c.

The default ./src/selections.c comes from a previous instance of the Data Lab at CMU.  The file ./src/selections-all.c contains the complete list of puzzles to choose from.

Step 2. Modify the Latex lab writeup in ./writeup/datalab.tex to tailor it for your course.

Step 3. Type the following in the current directory:
unix> make clean
unix> make

步骤 0：如果您决定运行“击败教授”竞赛（第5节），则需要编辑./contest/Contest.pm文件，以便驱动程序知道将结果发送到何处。请查看./contest/README文件，获取简单的说明。如果您决定*不*提供竞赛，则无需执行此步骤。

步骤 1：通过编辑./src/selections.c文件来选择您想要包含的谜题。

默认的./src/selections.c文件来自于CMU数据实验室的先前实例。文件./src/selections-all.c包含了完整的可供选择的谜题列表。

步骤 2：修改./writeup/datalab.tex中的Latex实验室报告，以适应您的课程。

步骤 3：在当前目录中输入以下命令：
```
unix> make clean
unix> make
```


The Makefile generates the btest source files, builds the dlc binary(if necessary), formats the lab writeup, and then copies btest, the dlc binary, and the driver to the handout directory.  After that, it builds a tarfile of the handout directory (in ./datalab-handout.tar) that you can then hand out to students.

Note on Binary Portability: dlc is distributed in the datalab-handout directory as a binary. Linux binaries are not always portable across distributions due to different versions of dynamic libraries. You'll need to be careful to compile dlc on a machine that is compatible with those that the students will be using.

Note: Running "make" also automatically generates the solutions to the puzzles, which you can find in ./src/bits.c and ./src/bits.c-solution.


******************
4. Grading the Lab
******************

There is a handy autograder script that automatically grades your
students' handins.  See ./grade/README for instructions.

**************************
5. "Beat the Prof" Contest
**************************

For fun, we've included an optional "Beat the Prof" contest, where
students compete against themselves and the instructor. The goal is to
solve each Data Lab puzzle using the fewest number of
operators. Students who match or beat the instructor's operator count
for each puzzle are winners. See ./contest/README for the simple
instructions on how to set up the contest.

NOTE: The contest is completely optional. Whether you decide to
offer it or not has no affect on how you build and distribute the lab.

NOTE: If you do decide to offer the contest, then you should configure
the contest *before* you build the lab, so that the driver knows the
server and port to send the contest results of each student (using the
constants defined in the ./src/Driverhdrs.pm file, which is
autogenerated from the ./contest/Contest.pm config file).

If you decide to offer the contest *after* you've built and handed out
the lab to the students, you're still OK:

1) Configure the contest as described in contest/Makefile

2) Rebuild the lab in the usual way:
   linux> cd datalab
   linux> make

3) Distribute the new ./src/Driverhdrs.pm file to the students.


***************************
6. Experimental BDD checker
***************************

For fun, we have included an experimental correctness checker based on
binary decision diagrams (BDDs) (R. E. Bryant, IEEE Transactions on
Computers, August, 1986) that uses the CUDD BDD package from the
University of Colorado. The BDD checker does an exhaustive test of the
test functions in bits.c, formally verifying the correctness of each
test function against a reference solution for *ALL* possible input
values. For functions that differ from the reference solution, the BDD
checker produces a counterexample in the form of a set of function
arguments that cause the test solution to differ from the reference
solution.

The sources are included in ./src/bddcheck. To compile:

unix> cd src/bddcheck
unix> make clean
unix> make

To use BDDs to check ./src/bits.c for correctness:

unix> cd src
unix> ./bddcheck/check.pl     # with error messages and counterexamples
unix> ./bddcheck/check.pl -g  # compact tabular output with no error messages

Note that check.pl must be run from the parent directory of ./bddcheck.

We've been using this BDD checker instead of btest at CMU for several
years and the code appears to be stable. The main weakness is in the
Perl code that extracts the functions from bits.c. It usually works,
but some things -- such as calls to other functions, or functions that
don't end with a single brace -- confuse it. So we're reluctant to
make it the default checker for the distributed CS:APP labs. However,
if you have any questions about the correctness of a particular
solution, then this is the authoritative way to decide.

Please send any comments about the BDD checker to randy.bryant@cs.cmu.edu.
